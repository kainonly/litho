<ng-template #searchRef>
  <nz-space>
    <nz-range-picker
      *nzSpaceItem
      [nzShowTime]="{ nzFormat: 'HH:mm' }"
      nzFormat="yyyy-MM-dd HH:mm"
      [nzDisabledDate]="disabledDate"
      [(ngModel)]="date"
      (ngModelChange)="getData(true)"
    ></nz-range-picker>
    <nz-button-group *nzSpaceItem>
      <button nz-button nzType="text" nz-tooltip="刷新" (click)="getData(true)">
        <i nz-icon nzType="reload"></i>
      </button>
      <button nz-button nzType="text" nz-tooltip="重置" (click)="clearSearch()">
        <i nz-icon nzType="clear"></i>
      </button>
    </nz-button-group>
  </nz-space>
</ng-template>

<nz-card [nzTitle]="searchRef">
  <nz-list nzItemLayout="vertical">
    <nz-list-item *ngFor="let item of items">
      <nz-list-item-meta>
        <nz-list-item-meta-title>{{ item.time | date: 'yyyy-MM-dd HH:mm:ss' }} </nz-list-item-meta-title>
      </nz-list-item-meta>
      <nz-descriptions nzSize="small" nzBordered [nzColumn]="3">
        <nz-descriptions-item nzTitle="IP 地址">{{ item.ip }}</nz-descriptions-item>
        <nz-descriptions-item nzTitle="ISP">{{ !item.detail?.isp ? '-' : item.detail.isp }}</nz-descriptions-item>
        <nz-descriptions-item nzTitle="地区">
          <nz-space [nzSplit]="split">
            <span *nzSpaceItem>{{ !item.detail?.country ? '-' : item.detail.country }}</span>
            <span *nzSpaceItem>{{ !item.detail?.province ? '-' : item.detail.province }}</span>
            <span *nzSpaceItem>{{ !item.detail?.city ? '-' : item.detail.city }}</span>
          </nz-space>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="UserAgent" [nzSpan]="2">{{ item.user_agent }}</nz-descriptions-item>
      </nz-descriptions>
      <nz-list-item-extra>
        <button nz-button nzType="text" nz-tooltip="例如：本次登录不是本人"> 有风险？ </button>
      </nz-list-item-extra>
    </nz-list-item>
    <div class="loadmore" nz-list-load-more>
      <button nz-button (click)="getData()">加载更多</button>
    </div>
    <nz-list-empty *ngIf="items.length === 0"></nz-list-empty>
  </nz-list>
</nz-card>

<ng-template #split>
  <nz-divider nzType="vertical"></nz-divider>
</ng-template>
