<nz-card #block style="height: 100%">
  <nz-row #box style="padding-bottom: 12px" nzJustify="space-between">
    <nz-col><ng-content select="nz-space[wpxSearch]"></ng-content></nz-col>
    <nz-col></nz-col>
    <nz-col><ng-content select="nz-space[wpxExtra]"></ng-content></nz-col>
  </nz-row>
  <ng-template #totalRef let-total>共 {{ total }} 条记录</ng-template>
  <nz-table
    #basicTable
    [nzData]="wpxModel.data()"
    [nzFrontPagination]="false"
    [nzShowPagination]="true"
    [nzShowSizeChanger]="true"
    [nzShowTotal]="totalRef"
    [nzTotal]="wpxModel.total"
    [(nzPageIndex)]="wpxModel.page"
    [(nzPageSize)]="wpxModel.pagesize"
    [nzPageSizeOptions]="[20, 50, 100, 500, 1000]"
    [nzVirtualItemSize]="wpxItemSize"
    [nzVirtualMinBufferPx]="wpxItemSize * 10"
    [nzVirtualMaxBufferPx]="wpxItemSize * 15"
    [nzScroll]="{ y: y() + 'px', x: '1200px' }"
    (nzPageIndexChange)="update()"
    (nzPageSizeChange)="update()"
  >
    <thead>
      <tr [ngStyle]="{ height: wpxItemSize + 'px' }">
        <th
          nzLeft
          nzAlign="center"
          nzWidth="60px"
          [nzChecked]="wpxModel.checked"
          [nzIndeterminate]="wpxModel.indeterminate"
          (nzCheckedChange)="wpxModel.setCurrentSelection($event)"
        ></th>
        <ng-container *ngFor="let x of wpxColumns">
          <th>
            <b>{{ x.title }}</b>
          </th>
        </ng-container>
      </tr>
    </thead>
    <tbody>
      <ng-container *nz-virtual-scroll="let v; index as index">
        <tr [ngStyle]="{ height: wpxItemSize + 'px' }" (contextmenu)="openActions($event, v)">
          <td
            nzLeft
            nzAlign="center"
            [nzDisabled]="v['disabled']"
            [nzChecked]="wpxModel.selection.has(v['_id'])"
            (nzCheckedChange)="$event ? wpxModel.setSelection(v) : wpxModel.removeSelection(v['_id'])"
          ></td>
          <ng-container *ngFor="let x of wpxColumns">
            <td>{{ v[x.key] }}</td>
          </ng-container>
        </tr>
      </ng-container>
    </tbody>
  </nz-table>
</nz-card>
