<ng-template #searchRef>
  <nz-input-group style="width: 180px" nzSuffixIcon="search">
    <input [(ngModel)]="searchText" (ngModelChange)="getData()" type="text" nz-input placeholder="用户名搜索" />
  </nz-input-group>
</ng-template>

<ng-template #actions>
  <button nz-button nzType="primary">
    Grafana 监控日志
    <i nz-icon nzType="select"></i>
  </button>
</ng-template>

<nz-card [nzTitle]="searchRef" [nzExtra]="actions">
  <nz-table #basicTable [nzData]="data" [nzHideOnSinglePage]="true">
    <thead>
      <tr>
        <th nzWidth="200px" nzLeft>时间</th>
        <th nzWidth="240px"><b>UID</b></th>
        <th nzWidth="240px"><b>用户名 / 电子邮件</b></th>
        <th><b>详情</b></th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let item of basicTable.data">
        <td>{{ item.time | date: 'yyyy-MM-dd hh:mm:ss' }} </td>
        <td>{{ item.user }}</td>
        <td>
          <nz-space [nzSplit]="split">
            <ng-template #split>
              <nz-divider nzType="vertical"></nz-divider>
            </ng-template>
            <span *nzSpaceItem>{{ item.username }}</span>
            <span *nzSpaceItem>{{ !!item.email ? item.email : '-' }}</span>
          </nz-space>
        </td>
        <td>
          <nz-space [nzSplit]="split">
            <ng-template #split>
              <nz-divider nzType="vertical"></nz-divider>
            </ng-template>
            <span *nzSpaceItem>TokenID： {{ item.token_id }}</span>
            <span *nzSpaceItem>IP： {{ item.ip }}</span>
            <span *nzSpaceItem>{{ !!item.detail.country ? item.detail.country : '-' }}</span>
            <span *nzSpaceItem>{{ !!item.detail.province ? item.detail.province : '-' }}</span>
            <span *nzSpaceItem>{{ !!item.detail.city ? item.detail.city : '-' }}</span>
            <span *nzSpaceItem>{{ !!item.detail.isp ? item.detail.isp : '-' }}</span>
          </nz-space>
        </td>
      </tr>
    </tbody>
  </nz-table>
</nz-card>
