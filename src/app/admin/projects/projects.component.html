<ng-template #titleRef>
  <nz-space nzAlign="center">
    <wpx-keyword
      *nzSpaceItem
      [wpxWidth]="320"
      [wpxModel]="model"
      [wpxKeys]="['name', 'namespace']"
      (wpxSubmit)="getData()"
      wpxPlaceholder="项目名称、命名空间"
    ></wpx-keyword>
    <wpx-toolbox *nzSpaceItem [wpxModel]="model" (wpxClear)="getData()" (wpxRefresh)="getData()"> </wpx-toolbox>
  </nz-space>
</ng-template>

<ng-template #extraRef>
  <button nz-button nzType="primary" (click)="open()"> 新增 </button>
</ng-template>

<wpx-list
  #wpxList
  [wpxModel]="model"
  [wpxTitle]="titleRef"
  [wpxExtra]="extraRef"
  [wpxRender]="render"
  [wpxActions]="actions"
  (wpxChange)="getData()"
>
  <ng-template #render let-item>
    <nz-ribbon [nzText]="item | expire">
      <nz-card nzSize="small" nzType="inner">
        <nz-space nzSize="large" nzAlign="start">
          <ng-container *nzSpaceItem>
            <ng-container *ngIf="item.logo; else nameAvatarRef">
              <nz-avatar
                nzShape="square"
                [nzSize]="128"
                [nzSrc]="[item.logo] | wpxAssets"
                style="font-size: 32px"
              ></nz-avatar>
            </ng-container>
            <ng-template #nameAvatarRef>
              <nz-avatar nzShape="square" [nzSize]="128" [nzText]="item.name" style="font-size: 32px"></nz-avatar>
            </ng-template>
          </ng-container>
          <div *nzSpaceItem>
            <ng-template #titleRef> {{ item.name }} <nz-tag nzColor="blue">标准类型</nz-tag> </ng-template>
            <nz-descriptions nzLayout="vertical" nzSize="small" [nzTitle]="titleRef" [nzColumn]="6">
              <nz-descriptions-item nzTitle="命名空间">
                <span nz-typography nzCopyable [nzContent]="item.namespace"></span>
              </nz-descriptions-item>
              <nz-descriptions-item nzTitle="OpenAPI 密钥" [nzSpan]="2">
                <ng-container *ngIf="item.secret_id && item.secret_key; else unsetRef">
                  <nz-space [nzSplit]="spaceSplit">
                    <span *nzSpaceItem nz-typography nzCopyable [nzContent]="item.secret_id"></span>
                    <span *nzSpaceItem nz-typography nzCopyable [nzCopyText]="item.secret_key" nzContent="KEY"></span>
                  </nz-space>
                </ng-container>
              </nz-descriptions-item>
              <nz-descriptions-item nzTitle="入口" [nzSpan]="3">
                <ng-container *ngIf="item.entry && item.entry.length !== 0; else unsetRef">
                  <p nz-typography nzEllipsis [nzEllipsisRows]="2" [nzContent]="item.entry.toString()"></p>
                </ng-container>
              </nz-descriptions-item>
            </nz-descriptions>
          </div>
        </nz-space>
      </nz-card>
    </nz-ribbon>
  </ng-template>
</wpx-list>

<nz-dropdown-menu #actions="nzDropdownMenu">
  <ul *ngIf="wpxList.actived as v" nz-menu>
    <li nz-menu-item nzDisabled>
      <b>{{ v.name }}</b>
    </li>
    <li nz-menu-divider></li>
    <li nz-menu-item (click)="openEntry(v)"> 设置入口 </li>
    <li nz-menu-item (click)="open(v)"> 修改 </li>
    <li nz-menu-item nzDanger (click)="delete(v)"> 删除 </li>
  </ul>
</nz-dropdown-menu>

<ng-template #unsetRef>未设置</ng-template>

<ng-template #spaceSplit>
  <nz-divider nzType="vertical"></nz-divider>
</ng-template>
