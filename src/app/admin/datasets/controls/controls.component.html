<nz-layout style="height: 100%; background: transparent">
  <nz-page-header>
    <nz-page-header-title>字段管理</nz-page-header-title>
    <nz-page-header-tags>
      <nz-tag>{{ name }}</nz-tag>
    </nz-page-header-tags>
    <nz-page-header-extra>
      <button nz-button nzType="primary" form="form" nzShape="circle" [disabled]="!form.valid">
        <span nz-icon nzType="check" nzTheme="outline"></span>
      </button>
    </nz-page-header-extra>
    <nz-page-header-footer>
      <nz-tabset nzSize="small" [(nzSelectedIndex)]="index">
        <nz-tab nzTitle="投影设置"></nz-tab>
        <nz-tab nzTitle="脱敏设置"></nz-tab>
      </nz-tabset>
    </nz-page-header-footer>
  </nz-page-header>

  <nz-content style="overflow: hidden auto">
    <form [ngSwitch]="index" nz-form nzLayout="vertical" id="form" [formGroup]="form" (wpxSubmit)="submit($event)">
      <nz-card *ngSwitchCase="0">
        <nz-table formArrayName="Keys" nzSize="middle" nzTemplateMode>
          <thead>
            <tr>
              <th nzWidth="60px"></th>
              <th><b>字段名称</b></th>
              <th nzWidth="60px" nzAlign="center">
                <button nz-button type="button" nzType="text" nz-tooltip="清空字段" (click)="keys.clear()">
                  <span nz-icon nzType="rest" nzTheme="outline"></span>
                </button>
              </th>
            </tr>
          </thead>
          <tbody cdkDropList (cdkDropListDropped)="sort($event, keys)">
            <tr *ngFor="let x of keys.controls; index as i" cdkDrag>
              <td nzAlign="center">
                <button nz-button type="button" nzType="text" cdkDragHandle>
                  <span nz-icon nzType="holder" nzTheme="outline"></span>
                </button>
              </td>
              <td>
                <input style="width: 100%" nzBorderless nz-input [formControlName]="i" placeholder="请输入字段名称" />
              </td>
              <td nzAlign="center">
                <button nz-button type="button" nzType="text" (click)="removeKey(i)">
                  <i nz-icon nzType="minus-circle"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </nz-table>
        <button nzBlock type="button" nzType="text" nzSize="large" nz-button (click)="appendKey()">
          <i nz-icon nzType="plus-circle"></i> 新增
        </button>
      </nz-card>
      <nz-card *ngSwitchCase="1">
        <nz-table formArrayName="Sensitives" nzSize="middle" nzTemplateMode>
          <thead>
            <tr>
              <th nzWidth="60px"></th>
              <th><b>字段名称</b></th>
              <th nzWidth="60px" nzAlign="center">
                <button nz-button type="button" nzType="text" nz-tooltip="清空字段" (click)="sensitives.clear()">
                  <span nz-icon nzType="rest" nzTheme="outline"></span>
                </button>
              </th>
            </tr>
          </thead>
          <tbody cdkDropList (cdkDropListDropped)="sort($event, sensitives)">
            <tr *ngFor="let x of sensitives.controls; index as i" cdkDrag>
              <td nzAlign="center">
                <button nz-button type="button" nzType="text" cdkDragHandle>
                  <span nz-icon nzType="holder" nzTheme="outline"></span>
                </button>
              </td>
              <td>
                <input style="width: 100%" nzBorderless nz-input [formControlName]="i" placeholder="请输入字段名称" />
              </td>
              <td nzAlign="center">
                <button nz-button type="button" nzType="text" (click)="removeSensitive(i)">
                  <i nz-icon nzType="minus-circle"></i>
                </button>
              </td>
            </tr>
          </tbody>
        </nz-table>
        <button nzBlock type="button" nzType="text" nzSize="large" nz-button (click)="appendSensitive()">
          <i nz-icon nzType="plus-circle"></i> 新增
        </button>
      </nz-card>
    </form>
  </nz-content>
</nz-layout>
