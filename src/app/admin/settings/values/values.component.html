<ng-template #titleRef>
  <nz-space>
    <nz-input-group *nzSpaceItem nzSuffixIcon="search" nz-tooltip="键盘 Enter 开始搜索" nzTooltipTrigger="focus">
      <input
        style="width: 180px"
        [(ngModel)]="searchText"
        (keyup.enter)="getData()"
        type="text"
        nz-input
        placeholder="键名"
        i18n-placeholder
      />
    </nz-input-group>
    <nz-button-group *nzSpaceItem>
      <button nz-button nzType="text" nz-tooltip="刷新" i18n-nz-tooltip (click)="getData()">
        <i nz-icon nzType="reload"></i>
      </button>
      <button nz-button nzType="text" nz-tooltip="重置" i18n-nz-tooltip (click)="clearSearch()">
        <i nz-icon nzType="clear"></i>
      </button>
    </nz-button-group>
  </nz-space>
</ng-template>

<ng-template #extraRef>
  <nz-space>
    <button *nzSpaceItem nz-button nzType="primary" (click)="form()" i18n> 新增 </button>
  </nz-space>
</ng-template>

<nz-card style="height: 100%" [nzTitle]="titleRef" [nzExtra]="extraRef">
  <nz-table
    [nzData]="items"
    [nzLoading]="loading"
    [nzFrontPagination]="false"
    [nzShowPagination]="false"
    [nzVirtualItemSize]="56"
    [nzVirtualMinBufferPx]="56 * 10"
    [nzVirtualMaxBufferPx]="56 * 15"
    [nzScroll]="{ y }"
  >
    <thead>
      <tr>
        <th nzWidth="320px"><b i18n>键名</b></th>
        <th><b i18n>键值</b></th>
      </tr>
    </thead>
    <tbody>
      <ng-container *nz-virtual-scroll="let data">
        <tr (contextmenu)="openActions($event, actions, data)">
          <td>{{ data.key }}</td>
          <td nzBreakWord>
            <code>{{ data.value }}</code>
          </td>
        </tr>
      </ng-container>
    </tbody>
  </nz-table>
</nz-card>

<nz-dropdown-menu #actions="nzDropdownMenu">
  <ul *ngIf="actived" nz-menu>
    <li nz-menu-item (click)="form(actived)" i18n>编辑</li>
    <li nz-menu-item nzDanger (click)="delete(actived.key)" i18n>删除</li>
  </ul>
</nz-dropdown-menu>
