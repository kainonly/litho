<nz-card>
  <nz-list nzSize="large" nzItemLayout="vertical">
    <nz-list-item>
      <nz-list-item-meta>
        <nz-list-item-meta-avatar>
          <ng-container [ngSwitch]="data['office']">
            <ng-container *ngSwitchCase="'feishu'">
              <nz-avatar
                nzShape="square"
                nzSize="large"
                [nzSrc]="['assets', 'office', 'feishu.png'] | wpxAssets"
              ></nz-avatar>
            </ng-container>
            <ng-container *ngSwitchCase="'dingtalk'">
              <nz-avatar
                nzShape="square"
                nzSize="large"
                [nzSrc]="['assets', 'office', 'dingtalk.png'] | wpxAssets"
              ></nz-avatar>
            </ng-container>
            <ng-container *ngSwitchCase="'work-weixin'">
              <nz-avatar
                nzShape="square"
                nzSize="large"
                [nzSrc]="['assets', 'office', 'work-weixin.png'] | wpxAssets"
              ></nz-avatar>
            </ng-container>
            <ng-container *ngSwitchDefault>
              <nz-avatar nzShape="square" nzSize="large" nzIcon="question"></nz-avatar>
            </ng-container>
          </ng-container>
        </nz-list-item-meta-avatar>
        <nz-list-item-meta-title>
          <b [ngSwitch]="data['office']">
            <ng-container *ngSwitchCase="'feishu'">飞书</ng-container>
            <ng-container *ngSwitchCase="'dingtalk'">钉钉</ng-container>
            <ng-container *ngSwitchCase="'work-weixin'">企业微信</ng-container>
            <ng-container *ngSwitchDefault>当前未关联企业平台</ng-container>
          </b>
        </nz-list-item-meta-title>
      </nz-list-item-meta>

      <nz-descriptions style="width: 800px" nzSize="small" nzBordered nzLayout="vertical" [nzColumn]="2">
        <nz-descriptions-item nzTitle="应用 ID">
          <ng-container *ngIf="data['feishu_app_id']; else unkown">
            {{ data['feishu_app_id'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="应用密钥">
          <ng-container *ngIf="data['feishu_app_secret']; else unkown"> 已设置 </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="事件订阅安全校验数据密钥">
          <ng-container *ngIf="data['feishu_encrypt_key']; else unkown"> 已设置 </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="事件订阅验证令牌">
          <ng-container *ngIf="data['feishu_verification_token']; else unkown"> 已设置 </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="第三方免登陆（允许通过企业平台用户身份进行登录）" [nzSpan]="2">
          <ng-container *ngIf="data['redirect_url']; else unkown">
            {{ data['redirect_url'] }}
          </ng-container>
        </nz-descriptions-item>
      </nz-descriptions>

      <nz-list-item-extra>
        <button nz-button nzType="primary" nzShape="circle" nz-tooltip="设置" (click)="setPlatform()">
          <i nz-icon nzType="tool"></i>
        </button>
        <!--        <button nz-button nzType="link" (click)="setPlatform()">设置</button>-->
        <ng-container *ngIf="!!data['office']">
          <button
            nz-button
            nzType="link"
            nzDanger
            nz-popconfirm
            nzPopconfirmTitle="您确定要取消该关联吗？"
            nzPopconfirmPlacement="bottom"
            (nzOnConfirm)="unset()"
          >
            取消关联
          </button>
        </ng-container>
      </nz-list-item-extra>
    </nz-list-item>
    <nz-list-item>
      <nz-list-item-meta>
        <nz-list-item-meta-title><b>公共邮件</b></nz-list-item-meta-title>
      </nz-list-item-meta>
      <nz-descriptions style="width: 800px" nzSize="small" nzLayout="vertical" nzBordered [nzColumn]="2">
        <nz-descriptions-item nzTitle="SMTP 地址">
          <ng-container *ngIf="data['email_host']; else unkown">
            {{ data['email_host'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="SMTP 端口号（SSL）">
          <ng-container *ngIf="data['email_port']; else unkown">
            {{ data['email_port'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="邮箱用户">
          <ng-container *ngIf="data['email_username']; else unkown">
            {{ data['email_username'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="密码">
          <ng-container *ngIf="data['email_password']; else unkown"> 已设置 </ng-container>
        </nz-descriptions-item>
      </nz-descriptions>
      <nz-list-item-extra>
        <button nz-button nzType="primary" nzShape="circle" nz-tooltip="设置" (click)="setEmail()">
          <i nz-icon nzType="tool"></i>
        </button>
      </nz-list-item-extra>
    </nz-list-item>
    <nz-list-item>
      <nz-list-item-meta>
        <nz-list-item-meta-title><b>开放服务</b></nz-list-item-meta-title>
      </nz-list-item-meta>
      <nz-descriptions style="width: 800px" nzSize="small" nzLayout="vertical" nzBordered [nzColumn]="2">
        <nz-descriptions-item nzTitle="地址" [nzSpan]="2">
          <ng-container *ngIf="data['openapi_url']; else unkown">
            {{ data['openapi_url'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="应用认证 Key">
          <ng-container *ngIf="data['openapi_key']; else unkown">
            {{ data['openapi_key'] }}
          </ng-container>
        </nz-descriptions-item>
        <nz-descriptions-item nzTitle="应用认证密钥">
          <ng-container *ngIf="data['openapi_secret']; else unkown"> 已设置 </ng-container>
        </nz-descriptions-item>
      </nz-descriptions>
      <nz-list-item-extra>
        <button nz-button nzType="primary" nzShape="circle" nz-tooltip="设置" (click)="setOpenapi()">
          <i nz-icon nzType="tool"></i>
        </button>
      </nz-list-item-extra>
    </nz-list-item>
  </nz-list>
</nz-card>

<ng-template #unkown>未设置</ng-template>
