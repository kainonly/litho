<ng-template #left>
  <nz-space nzAlign="center">
    <app-keyword
      *nzSpaceItem
      [appModel]="m"
      (appOnSearch)="getData(true)"
      appPlaceholder="Search ID, URL, name"
    ></app-keyword>
    <app-toolbox *nzSpaceItem [appModel]="m" (appRefresh)="getData(true)" (appClear)="getData(true)"></app-toolbox>
  </nz-space>
</ng-template>
<ng-template #right>
  <nz-space nzAlign="center">
    @if (m.selection.size !== 0) {
      <a nz-dropdown *nzSpaceItem [nzDropdownMenu]="bulkAction">
        Selected {{ m.selection.size }} items
        <span nz-icon nzType="down"></span>
      </a>
    }

    <nz-dropdown-menu #bulkAction>
      <ul nz-menu nzSelectable>
        <li nz-menu-item nzDanger (click)="bulkDelete()">Delete</li>
        <li nz-menu-divider></li>
        <li nz-menu-item (click)="m.clearSelections()">Cancel</li>
      </ul>
    </nz-dropdown-menu>

    <button *nzSpaceItem nz-button nzType="primary" (click)="open()">Create</button>
  </nz-space>
</ng-template>

<app-layout>
  <app-box #box [appLeft]="left" [appRight]="right">
    <nz-table
      #tb
      [style.height.%]="100"
      [nzLoading]="m.loading()"
      [nzData]="m.data()"
      [nzTotal]="m.total"
      [nzShowTotal]="box.totalRef"
      [nzFrontPagination]="false"
      [nzShowPagination]="true"
      [nzShowSizeChanger]="true"
      [nzPageSizeOptions]="[10, 20, 50]"
      [(nzPageIndex)]="m.page"
      [(nzPageSize)]="m.pagesize"
      (nzPageIndexChange)="getData()"
      (nzPageSizeChange)="getData()"
      [nzScroll]="box.scroll()"
    >
      <thead>
        <tr>
          <th
            nzLeft
            nzAlign="center"
            nzWidth="50px"
            [nzChecked]="m.checked"
            [nzIndeterminate]="m.indeterminate"
            (nzCheckedChange)="m.setCurrentSelections($event)"
          ></th>
          <th nzWidth="360px">
            <b>NAME</b>
          </th>
          <th nzWidth="240px">
            <b>TIME PATTERN</b>
          </th>
          <th>
            <b>URL</b>
          </th>
          <th nzWidth="240px">
            <b>RUNS IN</b>
          </th>
          <th nzRight nzAlign="center" nzWidth="50px">
            <button nz-button nzType="text">
              <nz-icon nzType="setting" />
            </button>
          </th>
        </tr>
      </thead>
      <tbody> </tbody>
    </nz-table>
  </app-box>
</app-layout>
