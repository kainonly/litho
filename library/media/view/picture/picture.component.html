<nz-row [nzGutter]="16">
  <nz-col [nzSpan]="15">
    <div class="photo">
      <img #painting [src]="[doc.url] | wpxAssets" [alt]="doc.name" />
    </div>
    <nz-descriptions style="margin-top: 16px" [nzColumn]="2">
      <nz-descriptions-item nzTitle="名称" i18n-nzTitle [nzSpan]="2">{{ doc.name }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="原图宽度" i18n-nzTitle>{{ original?.width }} PX</nz-descriptions-item>
      <nz-descriptions-item nzTitle="原图高度" i18n-nzTitle>{{ original?.height }} PX</nz-descriptions-item>
      <nz-descriptions-item nzTitle="原图类型" i18n-nzTitle>{{ original?.format }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="原图大小" i18n-nzTitle>{{ original?.size | nzBytes }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="加载类型" i18n-nzTitle>{{ output?.format }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="加载大小" i18n-nzTitle>{{ output?.size | nzBytes }}</nz-descriptions-item>
      <nz-descriptions-item nzTitle="路径" i18n-nzTitle [nzSpan]="2">{{ [doc.url] | wpxAssets }}</nz-descriptions-item>
    </nz-descriptions>
  </nz-col>
  <nz-col [nzSpan]="9">
    <form *ngIf="form" nz-form nzLayout="vertical" id="form" [formGroup]="form" (wpxSubmit)="submit($event)">
      <nz-form-item>
        <nz-form-label i18n>
          预览
          <button style="margin-left: 4px" nz-button type="button" nzType="text" (click)="updateQuery()">
            <span nz-icon nzType="sync"></span>
          </button>
        </nz-form-label>
        <nz-form-control>
          <div class="photo">
            <img nz-image [nzSrc]="[doc.url] | wpxAssets : query" [alt]="doc.name" />
          </div>
        </nz-form-control>
      </nz-form-item>
      <nz-form-item>
        <nz-form-label nzRequired i18n>加工方式</nz-form-label>
        <nz-form-control>
          <nz-radio-group formControlName="mode" (ngModelChange)="watchMode($event)">
            <label nz-radio-button [nzValue]="0" i18n>不缩放</label>
            <label nz-radio-button [nzValue]="1" i18n>只裁剪</label>
            <label nz-radio-button [nzValue]="2" i18n>只缩放</label>
            <label nz-radio-button [nzValue]="3" i18n>缩放+裁剪</label>
          </nz-radio-group>
        </nz-form-control>
      </nz-form-item>
      <ng-container *ngIf="[1, 3].includes(mode.value)" formGroupName="cut">
        <nz-form-item>
          <nz-form-label nzRequired i18n>裁剪尺寸</nz-form-label>
          <nz-form-control>
            <nz-input-number-group>
              <nz-input-number-group style="width: 50%; margin-right: -1px" nzSuffix="PX" nzPrefix="宽" i18n-nzPrefix>
                <nz-input-number
                  formControlName="w"
                  nzPrecisionMode="cut"
                  [nzPrecision]="0"
                  (ngModelChange)="updateCrop()"
                ></nz-input-number>
              </nz-input-number-group>
              <nz-input-number-group style="width: 50%" nzSuffix="PX" nzPrefix="高" i18n-nzPrefix>
                <nz-input-number
                  formControlName="h"
                  nzPrecisionMode="cut"
                  [nzPrecision]="0"
                  (ngModelChange)="updateCrop()"
                ></nz-input-number>
              </nz-input-number-group>
            </nz-input-number-group>
          </nz-form-control>
        </nz-form-item>
        <nz-form-item>
          <nz-form-label nzRequired i18n>裁剪偏移</nz-form-label>
          <nz-form-control>
            <nz-input-number-group>
              <nz-input-number-group style="width: 50%; margin-right: -1px" nzSuffix="PX" nzPrefix="向右" i18n-nzPrefix>
                <nz-input-number
                  formControlName="x"
                  nzPrecisionMode="cut"
                  [nzPrecision]="0"
                  (ngModelChange)="updateCrop()"
                ></nz-input-number>
              </nz-input-number-group>
              <nz-input-number-group style="width: 50%" nzSuffix="PX" nzPrefix="向下" i18n-nzPrefix>
                <nz-input-number
                  formControlName="y"
                  nzPrecisionMode="cut"
                  [nzPrecision]="0"
                  (ngModelChange)="updateCrop()"
                ></nz-input-number>
              </nz-input-number-group>
            </nz-input-number-group>
          </nz-form-control>
        </nz-form-item>
      </ng-container>
      <nz-form-item *ngIf="[2, 3].includes(mode.value)" formGroupName="zoom">
        <nz-form-label nzRequired i18n>缩放尺寸</nz-form-label>
        <nz-form-control nzExtra="宽或高非0为空时将等比缩放" i18n-nzExtra>
          <nz-input-number-group>
            <nz-input-number-group style="width: 50%; margin-right: -1px" nzSuffix="PX" nzPrefix="宽" i18n-nzPrefix>
              <nz-input-number formControlName="w" nzPrecisionMode="cut" [nzPrecision]="0"></nz-input-number>
            </nz-input-number-group>
            <nz-input-number-group style="width: 50%" nzSuffix="PX" nzPrefix="高" i18n-nzPrefix>
              <nz-input-number formControlName="h" nzPrecisionMode="cut" [nzPrecision]="0"></nz-input-number>
            </nz-input-number-group>
          </nz-input-number-group>
        </nz-form-control>
      </nz-form-item>
    </form>
  </nz-col>
</nz-row>

<div *nzModalFooter>
  <button nz-button type="button" nzType="default" (click)="close()" i18n>取消</button>
  <button nz-button nzType="primary" form="form" i18n>提交</button>
</div>
