<div style="height: 100%">
  <div class="header">
    <nz-row nzJustify="space-between">
      <nz-col>
        <nz-space [nzSplit]="split">
          <ng-template #split>
            <nz-divider nzType="vertical"></nz-divider>
          </ng-template>
          <ng-container *nzSpaceItem>
            <button nz-button nzType="text" (click)="quick()">
              <span nz-icon nzType="appstore"></span>
            </button>
          </ng-container>
          <nz-breadcrumb *nzSpaceItem class="breadcrumb" nzAutoGenerate>
            <nz-breadcrumb-item *ngIf="app.project as p">
              <a [routerLink]="['/', p.namespace]" i18n> 项目【{{ p.name }}】</a>
            </nz-breadcrumb-item>
          </nz-breadcrumb>
        </nz-space>
      </nz-col>
      <nz-col> </nz-col>
      <nz-col>
        <div
          class="center"
          nz-popover
          [nzPopoverContent]="centerTpl"
          nzPopoverPlacement="bottomRight"
          nzPopoverTrigger="click"
        >
          <ng-container *ngIf="app.user as u">
            <nz-badge nzDot>
              <ng-container *ngIf="!!u.avatar; else defaultAvatar">
                <nz-avatar nzShape="square" [nzSize]="25" [nzSrc]="[u.avatar] | wpxAssets"></nz-avatar>
              </ng-container>
              <ng-template #defaultAvatar>
                <nz-avatar nzShape="square" [nzSize]="25" nzIcon="user"></nz-avatar>
              </ng-template>
            </nz-badge>
            <span class="username">
              <ng-container *ngIf="!u.name; else name">
                {{ u.email | uppercase }}
              </ng-container>
              <ng-template #name>
                {{ u.name | uppercase }}
              </ng-template>
            </span>
          </ng-container>
        </div>
      </nz-col>
    </nz-row>
  </div>
  <router-outlet></router-outlet>
</div>

<ng-template #quickTitleTpl>
  <nz-row nzJustify="space-between">
    <nz-col i18n>快捷导航</nz-col>
    <nz-col></nz-col>
    <nz-col>
      <a [routerLink]="['/']" (click)="closeQuick()" i18n> 管理后台 </a>
    </nz-col>
  </nz-row>
</ng-template>

<ng-template #centerTpl>
  <nz-tabset style="width: 360px" [nzTabBarExtraContent]="actions">
    <ng-template #actions>
      <nz-space>
        <app-translation *nzSpaceItem [simple]="true"></app-translation>
        <button *nzSpaceItem nz-button nzType="text" nz-tooltip="个人中心" i18n-nz-tooltip (click)="profile()">
          <i nz-icon nzType="user"></i>
        </button>
        <button *nzSpaceItem nz-button nzType="text" nz-tooltip="退出" i18n-nz-tooltip (click)="logout()">
          <i nz-icon nzType="logout"></i>
        </button>
      </nz-space>
    </ng-template>
    <nz-tab nzTitle="通知(0)" i18n-nzTitle>
      <nz-list nzItemLayout="horizontal">
        <nz-list-empty></nz-list-empty>
      </nz-list>
    </nz-tab>
    <nz-tab nzTitle="任务(0)" i18n-nzTitle>
      <nz-list nzItemLayout="horizontal">
        <nz-list-empty></nz-list-empty>
      </nz-list>
    </nz-tab>
  </nz-tabset>
</ng-template>
